SD.discharge = sd(Estimate.discharge[error.discharge=="None"], na.rm=T),
Correct.discharge = 100*mean(LB95.discharge < Truth & UB95.discharge > Truth)
)%>%
mutate(Scenario = paste("Scenario",scenario))
rm(list = ls())
file.list <- c("../simulation_results/Simulation_Results_80003_155000.rdata",
"../simulation_results/Simulation_Results80000.rdata")
file = file.list[1]
load(file)
truth <- select(results, simid, betaR:trtD2) %>%
pivot_longer(names_to = "Parameter", values_to = "Truth", cols = betaR:trtD2) %>%
mutate(Parameter = rep(results$competingJoint[[1]]$Parameter, nrow(results)))
results1 <- results %>%
select(competingJoint, simid,betaR:trtD2, competingError) %>%
unnest(competingJoint)%>%
select(-Raw, -Raw.SE, -p, -H0) %>%
mutate(Estimate = ifelse(Parameter == "Sigma", Estimate^2, Estimate),
LB95 = ifelse(Parameter == "Sigma", LB95^2, LB95),
UB95 = ifelse(Parameter == "Sigma", UB95^2, UB95))
results1$scenario <- select(results1, betaR:trtD2) %>% apply(1, paste0, collapse=" ") %>% factor %>% as.numeric
# Death Joint Model
results2 <-results %>%
select(deathJoint, simid, deathError) %>%
unnest(deathJoint) %>%
select(-Raw, -Raw.SE, -p) %>%
mutate(
LB95 = Estimate - 2*Estimate.SE,
UB95 = Estimate + 2*Estimate.SE)
# Discharge Joint Model
results3 <- results %>%
select(dischargeJoint, simid, dischargeError) %>%
unnest(dischargeJoint) %>%
select(-Raw, -Raw.SE, -p) %>%
mutate(
LB95 = Estimate - 2*Estimate.SE,
UB95 = Estimate + 2*Estimate.SE,
Parameter = gsub("1","2",Parameter))
### Merge Results
merged <- results1 %>% ungroup %>%
left_join(results2, by = c("Parameter","simid"), suffix = c("",".death")) %>%
left_join(results3, by = c("Parameter","simid"), suffix = c("",".discharge")) %>%
left_join(truth, by = c("Parameter","simid"))
table(results$competingError)
table(results$deathError)
table(results$dischargeError)
sumtab <-
merged %>%
#mutate( old = simid <80001) %>%
group_by(scenario, Parameter) %>%
summarise(
Truth = Truth[1],
Mean = mean(Estimate[competingError=="None"]),
SD = sd(Estimate[competingError=="None"], na.rm=T),
Correct = 100*mean((LB95 < Truth & UB95 > Truth)[competingError=="None"]),
Mean.death = mean(Estimate.death[deathError=="None"]),
SD.death = sd(Estimate.death[deathError=="None"], na.rm=T),
Correct.death = 100*mean((LB95.death < Truth & UB95.death > Truth)[deathError=="None"]),
Mean.discharge = mean(Estimate.discharge[dischargeError=="None"]),
SD.discharge = sd(Estimate.discharge[dischargeError=="None"], na.rm=T),
Correct.discharge = 100*mean((LB95.discharge < Truth & UB95.discharge > Truth)[dischargeError=="None"])
)%>%
mutate(Scenario = paste("Scenario",scenario))
head(sumtab)
sumtab <-
merged %>%
#mutate( old = simid <80001) %>%
group_by(scenario, Parameter) %>%
summarise(
Truth = Truth[1],
Mean = mean(Estimate[competingError==1]),
SD = sd(Estimate[competingError==1], na.rm=T),
Correct = 100*mean((LB95 < Truth & UB95 > Truth)[competingError==1]),
Mean.death = mean(Estimate.death[deathError==1]),
SD.death = sd(Estimate.death[deathError==1], na.rm=T),
Correct.death = 100*mean((LB95.death < Truth & UB95.death > Truth)[deathError==1]),
Mean.discharge = mean(Estimate.discharge[dischargeError==1]),
SD.discharge = sd(Estimate.discharge[dischargeError==1], na.rm=T),
Correct.discharge = 100*mean((LB95.discharge < Truth & UB95.discharge > Truth)[dischargeError==1])
)%>%
mutate(Scenario = paste("Scenario",scenario))
sumtab
sumtab
merged %>%
filter(simid < 90000 & simid > 85000) %>%
group_by( Parameter) %>%
summarise(
Truth = Truth[1],
Mean = mean(Estimate[competingError==1]),
SD = sd(Estimate[competingError==1], na.rm=T),
Correct = 100*mean((LB95 < Truth & UB95 > Truth)[competingError==1]))
merged %>%
group_by( Parameter) %>%
summarise(
Truth = Truth[1],
Mean = mean(Estimate[competingError==1]),
SD = sd(Estimate[competingError==1], na.rm=T),
Correct = 100*mean((LB95 < Truth & UB95 > Truth)[competingError==1]))
merged %>% filter(Parameter == "Alpha, Terminal2") %>%
group_by( Truth) %>%
summarise(
Mean = mean(Estimate[competingError==1]),
SD = sd(Estimate[competingError==1], na.rm=T),
Correct = 100*mean((LB95 < Truth & UB95 > Truth)[competingError==1]))
merged %>% filter(Parameter == "Alpha, Terminal2") %>%
ggplot() +
geom_point(aes(x = simid, y = Estimate))
geom_point(aes(x = simid, y = Estimate)) + ylim(-3,3)
merged %>% filter(Parameter == "Alpha, Terminal2") %>%
ggplot() +
geom_point(aes(x = simid, y = Estimate)) + ylim(-3,3)
merged %>% filter(Parameter == "Alpha, Terminal2") %>%
ggplot()+
geom_line(aes(x = simid, y = Estimate))+
stat_smooth(aes(x = simid, y = Estimate), se = F)
merged %>% filter(Parameter == "Alpha, Terminal2") %>%
ggplot()+
stat_smooth(aes(x = simid, y = Estimate), se = F)
merged %>% filter(Parameter == "Alpha, Terminal2" & simid < 100000) %>%
ggplot()+
geom_point(aes(x = simid, y = Estimate)) + ylim(-3,3)
merged %>% filter(Parameter == "Alpha, Terminal2" & simid < 100000) %>%
ggplot()+
geom_point(aes(x = simid, y = Estimate), alpha = .2) + ylim(-3,3)
rm(list = ls())
load("../simulation_results/Simulation_Results_80003_155000.rdata")
head(results)
results <- select(results, simid, deaths:trtD2)
lm(data = results, deaths ~alpha2)
lm(data = results, deaths ~ factor(alpha2))
lm(data = results, deaths ~ factor(alpha2)) %>% summary
lm(data = results, deaths ~ factor(theta) + factor(alpha1) + factor(alpha2) +
factor(trtR)+ factor(trtD)+ factor(trtD2)) %>% summary
results %>% filter(theta == 0.5, alpha1 == 0, trtR == 0, trtD ==0, trtD2 ==0)
results %>% filter(theta == 0.5, alpha1 == 0, trtR == 0, trtD ==0, trtD2 ==0)  %>%
pivot_longer(cols = deaths : events.pl)
results %>% filter(theta == 0.5, alpha1 == 0, trtR == 0, trtD ==0, trtD2 ==0)  %>%
pivot_longer(cols = deaths : events.pl) %>%
group_by(alpha2, name) %>% summarise(mean(value))
results %>% filter(theta == 0.5, alpha1 == 0, trtR == 0, trtD ==0, trtD2 ==0)  %>%
pivot_longer(cols = deaths : events.pl) %>%
group_by(alpha2, name) %>% summarise(m = mean(value)) %>%
pivot_wider(names_from = "name", values_from = "m")
results %>% filter(theta == 0.5, alpha2 ==0, alpha1 == 0, trtD ==0, trtD2 ==0)  %>%
pivot_longer(cols = deaths : events.pl) %>%
group_by(trtR, name) %>%
summarise(m = mean(value)) %>%
pivot_wider(names_from = "name", values_from = "m")
results %>% filter(theta == 0.5, alpha2 ==0, alpha1 == 0, trtR == 0, trtD ==0)  %>%
pivot_longer(cols = deaths : events.pl) %>%
group_by(trtD2, name) %>%
summarise(m = mean(value)) %>%
pivot_wider(names_from = "name", values_from = "m")
results %>% filter( alpha2 ==0, alpha1 == 0, trtR == 0, trtD ==0, trtD2 ==0)  %>%
pivot_longer(cols = deaths : events.pl) %>%
group_by(theta, name) %>%
summarise(m = mean(value)) %>%
pivot_wider(names_from = "name", values_from = "m")
1%%729
2%%729
library(tidyverse)
set.seed(20220107)
simValues <-
expand.grid(betaR = 1, etaR = 10,
betaD = 1.85, etaD = 25,
betaD2 = 1.15, etaD2 = 10,
theta = c(0.1, 0.2, 0.5),
alpha1 = c(-0.5, 0, 0.5),
alpha2 = c(-0.5, 0, 0.5),
trtR = c(-0.1, 0, 0.1),
trtD = c(-0.1, 0, 0.1),
trtD2 = c(-0.1, 0, 0.1),
i = 1:5000) %>%
mutate(simid = 1:n(),
scenario = simid %% 729,
seed = cumsum(1000 + rpois(n(),10)),
n = 1500)
saveRDS(simValues, file = "../simulation_results/Simulation_Values_MetaData.rdata")
rm(list = ls())
library(tidyverse)
library(gt)
file.list <- c("../simulation_results/Simulation_Results_80003_155000.rdata",
"../simulation_results/Simulation_Results80000.rdata")
file = file.list[1]
load(file)
truth <- select(results, simid, betaR:trtD2) %>%
pivot_longer(names_to = "Parameter", values_to = "Truth", cols = betaR:trtD2) %>%
mutate(Parameter = rep(results$competingJoint[[1]]$Parameter, nrow(results)),
scenario = simid %% 729)
truth
results1 <- results %>%
select(competingJoint, simid,betaR:trtD2, competingError) %>%
unnest(competingJoint)%>%
select(-Raw, -Raw.SE, -p, -H0) %>%
mutate(Estimate = ifelse(Parameter == "Sigma", Estimate^2, Estimate),
LB95 = ifelse(Parameter == "Sigma", LB95^2, LB95),
UB95 = ifelse(Parameter == "Sigma", UB95^2, UB95))
# Death Joint Model
results2 <-results %>%
select(deathJoint, simid, deathError) %>%
unnest(deathJoint) %>%
select(-Raw, -Raw.SE, -p) %>%
mutate(
LB95 = Estimate - 2*Estimate.SE,
UB95 = Estimate + 2*Estimate.SE)
# Discharge Joint Model
results3 <- results %>%
select(dischargeJoint, simid, dischargeError) %>%
unnest(dischargeJoint) %>%
select(-Raw, -Raw.SE, -p) %>%
mutate(
LB95 = Estimate - 2*Estimate.SE,
UB95 = Estimate + 2*Estimate.SE,
Parameter = gsub("1","2",Parameter))
### Merge Results
merged <- results1 %>% ungroup %>%
left_join(results2, by = c("Parameter","simid"), suffix = c("",".death")) %>%
left_join(results3, by = c("Parameter","simid"), suffix = c("",".discharge")) %>%
left_join(truth, by = c("Parameter","simid"))
rm(results, results1, results2, results3, truth)
sumtab <-
merged %>%
#mutate( old = simid <80001) %>%
group_by(scenario, Parameter) %>%
summarise(
Truth = Truth[1],
Mean = mean(Estimate[competingError==1]),
SD = sd(Estimate[competingError==1], na.rm=T),
Correct = 100*mean((LB95 < Truth & UB95 > Truth)[competingError==1]),
Mean.death = mean(Estimate.death[deathError==1]),
SD.death = sd(Estimate.death[deathError==1], na.rm=T),
Correct.death = 100*mean((LB95.death < Truth & UB95.death > Truth)[deathError==1]),
Mean.discharge = mean(Estimate.discharge[dischargeError==1]),
SD.discharge = sd(Estimate.discharge[dischargeError==1], na.rm=T),
Correct.discharge = 100*mean((LB95.discharge < Truth & UB95.discharge > Truth)[dischargeError==1])
)
head(sumtab)
1%%729
min(merged$simid)
file.list <- c("../simulation_results/Simulation_Results_80003_155000.rdata",
"../simulation_results/Simulation_Results80000.rdata")
file = file.list[1]
load(file)
truth <- select(results, simid, betaR:trtD2) %>%
pivot_longer(names_to = "Parameter", values_to = "Truth", cols = betaR:trtD2) %>%
mutate(Parameter = rep(results$competingJoint[[1]]$Parameter, nrow(results)),
scenario = simid %% 729)
truth <- select(results, simid, betaR:trtD2) %>%
pivot_longer(names_to = "Parameter", values_to = "Truth", cols = betaR:trtD2) %>%
mutate(Parameter = rep(results$competingJoint[[1]]$Parameter, nrow(results)),
scenario = ((simid-1) %% 729)+1)
table(truth$scenario)
head(truth)
table(truth$scenario)/12
results1 <- results %>%
select(competingJoint, simid,betaR:trtD2, competingError) %>%
unnest(competingJoint)%>%
select(-Raw, -Raw.SE, -p, -H0) %>%
mutate(Estimate = ifelse(Parameter == "Sigma", Estimate^2, Estimate),
LB95 = ifelse(Parameter == "Sigma", LB95^2, LB95),
UB95 = ifelse(Parameter == "Sigma", UB95^2, UB95))
# Death Joint Model
results2 <-results %>%
select(deathJoint, simid, deathError) %>%
unnest(deathJoint) %>%
select(-Raw, -Raw.SE, -p) %>%
mutate(
LB95 = Estimate - 2*Estimate.SE,
UB95 = Estimate + 2*Estimate.SE)
# Discharge Joint Model
results3 <- results %>%
select(dischargeJoint, simid, dischargeError) %>%
unnest(dischargeJoint) %>%
select(-Raw, -Raw.SE, -p) %>%
mutate(
LB95 = Estimate - 2*Estimate.SE,
UB95 = Estimate + 2*Estimate.SE,
Parameter = gsub("1","2",Parameter))
### Merge Results
merged <- results1 %>% ungroup %>%
left_join(results2, by = c("Parameter","simid"), suffix = c("",".death")) %>%
left_join(results3, by = c("Parameter","simid"), suffix = c("",".discharge")) %>%
left_join(truth, by = c("Parameter","simid"))
sumtab <-
merged %>%
#mutate( old = simid <80001) %>%
group_by(scenario, Parameter) %>%
summarise(
Truth = Truth[1],
Mean = mean(Estimate[competingError==1]),
SD = sd(Estimate[competingError==1], na.rm=T),
Correct = 100*mean((LB95 < Truth & UB95 > Truth)[competingError==1]),
Mean.death = mean(Estimate.death[deathError==1]),
SD.death = sd(Estimate.death[deathError==1], na.rm=T),
Correct.death = 100*mean((LB95.death < Truth & UB95.death > Truth)[deathError==1]),
Mean.discharge = mean(Estimate.discharge[dischargeError==1]),
SD.discharge = sd(Estimate.discharge[dischargeError==1], na.rm=T),
Correct.discharge = 100*mean((LB95.discharge < Truth & UB95.discharge > Truth)[dischargeError==1])
)
sumtab
filter(sumtab, Parameter == "Alpha, Terminal2")
library(tidyverse)
set.seed(20220107)
simValues <-
expand.grid(betaR = 1, etaR = 10,
betaD = 1.85, etaD = 25,
betaD2 = 1.15, etaD2 = 10,
theta = c(0.1, 0.2, 0.5),
alpha1 = c(-0.5, 0, 0.5),
alpha2 = c(-0.5, 0, 0.5),
trtR = c(-0.1, 0, 0.1),
trtD = c(-0.1, 0, 0.1),
trtD2 = c(-0.1, 0, 0.1),
i = 1:5000) %>%
mutate(simid = 1:n(),
scenario = ((simid-1) %% 729)+1,
seed = cumsum(1000 + rpois(n(),10)),
n = 1500)
saveRDS(simValues, file = "../simulation_results/Simulation_Values_MetaData.rdata")
simValues <-
expand.grid(betaR = 1, etaR = 10,
betaD = 1.85, etaD = 25,
betaD2 = 1.15, etaD2 = 10,
theta = 0.2,
alpha1 = 0,
alpha2 = 0,
trtR = 0,
trtD = 0,
trtD2 = 0,
i = 1:5000) %>%
mutate(simid = 1:n(),
scenario = ((simid-1) %% 729)+1,
seed = cumsum(1000 + rpois(n(),10)),
n = 1500)
saveRDS(simValues, file = "../simulation_results/Simulation_Values_MetaData_Test.rdata")
dim(simValues)
simValues <-
expand.grid(betaR = 1, etaR = 10,
betaD = 1.85, etaD = 25,
betaD2 = 1.15, etaD2 = 10,
theta = 0.2,
alpha1 = 0,
alpha2 = 0,
trtR = 0,
trtD = 0,
trtD2 = 0,
i = 1:1000) %>%
mutate(simid = 1:n(),
scenario = ((simid-1) %% 729)+1,
seed = cumsum(1000 + rpois(n(),10)),
n = 1500)
saveRDS(simValues, file = "../simulation_results/Simulation_Values_MetaData_Test.rdata")
rm(list = ls())
file = file.list[2]
file.list <- c("../simulation_results/Simulation_Results_80003_155000.rdata",
"../simulation_results/Simulation_Results80000.rdata")
file = file.list[2]
load(file)
load( file = "Averaged_Estimates.rdata")
head(sumtab)
file = "../simulation_results/Test_Simulation_Results_1_1000.rdata"
load(file)
head(results)
truth <- select(results, simid, betaR:trtD2) %>%
pivot_longer(names_to = "Parameter", values_to = "Truth", cols = betaR:trtD2) %>%
mutate(Parameter = rep(results$competingJoint[[1]]$Parameter, nrow(results)),
scenario = ((simid-1) %% 729)+1)
library(tidyverse)
library(gt)
truth <- select(results, simid, betaR:trtD2) %>%
pivot_longer(names_to = "Parameter", values_to = "Truth", cols = betaR:trtD2) %>%
mutate(Parameter = rep(results$competingJoint[[1]]$Parameter, nrow(results)),
scenario = ((simid-1) %% 729)+1)
results1 <- results %>%
select(competingJoint, simid,betaR:trtD2, competingError) %>%
unnest(competingJoint)%>%
select(-Raw, -Raw.SE, -p, -H0) %>%
mutate(Estimate = ifelse(Parameter == "Sigma", Estimate^2, Estimate),
LB95 = ifelse(Parameter == "Sigma", LB95^2, LB95),
UB95 = ifelse(Parameter == "Sigma", UB95^2, UB95))
# Death Joint Model
results2 <-results %>%
select(deathJoint, simid, deathError) %>%
unnest(deathJoint) %>%
select(-Raw, -Raw.SE, -p) %>%
mutate(
LB95 = Estimate - 2*Estimate.SE,
UB95 = Estimate + 2*Estimate.SE)
# Discharge Joint Model
results3 <- results %>%
select(dischargeJoint, simid, dischargeError) %>%
unnest(dischargeJoint) %>%
select(-Raw, -Raw.SE, -p) %>%
mutate(
LB95 = Estimate - 2*Estimate.SE,
UB95 = Estimate + 2*Estimate.SE,
Parameter = gsub("1","2",Parameter))
### Merge Results
merged <- results1 %>% ungroup %>%
left_join(results2, by = c("Parameter","simid"), suffix = c("",".death")) %>%
left_join(results3, by = c("Parameter","simid"), suffix = c("",".discharge")) %>%
left_join(truth, by = c("Parameter","simid"))
rm(results, results1, results2, results3, truth)
sumtab <-
merged %>%
#mutate( old = simid <80001) %>%
group_by(scenario, Parameter) %>%
summarise(
Truth = Truth[1],
Mean = mean(Estimate[competingError==1]),
SD = sd(Estimate[competingError==1], na.rm=T),
Correct = 100*mean((LB95 < Truth & UB95 > Truth)[competingError==1]),
Mean.death = mean(Estimate.death[deathError==1]),
SD.death = sd(Estimate.death[deathError==1], na.rm=T),
Correct.death = 100*mean((LB95.death < Truth & UB95.death > Truth)[deathError==1]),
Mean.discharge = mean(Estimate.discharge[dischargeError==1]),
SD.discharge = sd(Estimate.discharge[dischargeError==1], na.rm=T),
Correct.discharge = 100*mean((LB95.discharge < Truth & UB95.discharge > Truth)[dischargeError==1])
)
save(sumtab, file = "Test_Averaged_Estimates.rdata")
merged$scenario <- 1
sumtab <-
merged %>%
#mutate( old = simid <80001) %>%
group_by(scenario, Parameter) %>%
summarise(
Truth = Truth[1],
Mean = mean(Estimate[competingError==1]),
SD = sd(Estimate[competingError==1], na.rm=T),
Correct = 100*mean((LB95 < Truth & UB95 > Truth)[competingError==1]),
Mean.death = mean(Estimate.death[deathError==1]),
SD.death = sd(Estimate.death[deathError==1], na.rm=T),
Correct.death = 100*mean((LB95.death < Truth & UB95.death > Truth)[deathError==1]),
Mean.discharge = mean(Estimate.discharge[dischargeError==1]),
SD.discharge = sd(Estimate.discharge[dischargeError==1], na.rm=T),
Correct.discharge = 100*mean((LB95.discharge < Truth & UB95.discharge > Truth)[dischargeError==1])
)
save(sumtab, file = "Test_Averaged_Estimates.rdata")
sumtab
sumtab
library(tidyverse)
set.seed(20220107)
simValues <-
expand.grid(betaR = 1, etaR = 10,
betaD = 1.85, etaD = 25,
betaD2 = 1.15, etaD2 = 10,
theta = c(0.1, 0.2, 0.5),
alpha1 = c(-0.5, 0, 0.5),
alpha2 = c(-0.5, 0, 0.5),
trtR = c(-0.1, 0, 0.1),
trtD = c(-0.1, 0, 0.1),
trtD2 = c(-0.1, 0, 0.1),
i = 1:5000) %>%
mutate(simid = 1:n(),
scenario = ((simid-1) %% 729)+1,
seed = cumsum(1000 + rpois(n(),10)),
n = 1500)
saveRDS(simValues, file = "../simulation_results/Simulation_Values_MetaData.rdata")
file = "../simulation_results/Simulation_Results_155001_161746.rdata"
load(file)
head(results)
truth <- select(results, simid, betaR:trtD2) %>%
pivot_longer(names_to = "Parameter", values_to = "Truth", cols = betaR:trtD2) %>%
mutate(Parameter = rep(results$competingJoint[[1]]$Parameter, nrow(results)),
scenario = ((simid-1) %% 729)+1)
results1 <- results %>%
select(competingJoint, simid,betaR:trtD2, competingError) %>%
unnest(competingJoint)%>%
select(-Raw, -Raw.SE, -p, -H0) %>%
mutate(Estimate = ifelse(Parameter == "Sigma", Estimate^2, Estimate),
LB95 = ifelse(Parameter == "Sigma", LB95^2, LB95),
UB95 = ifelse(Parameter == "Sigma", UB95^2, UB95))
# Death Joint Model
results2 <-results %>%
select(deathJoint, simid, deathError) %>%
unnest(deathJoint) %>%
select(-Raw, -Raw.SE, -p) %>%
mutate(
LB95 = Estimate - 2*Estimate.SE,
UB95 = Estimate + 2*Estimate.SE)
# Discharge Joint Model
results3 <- results %>%
select(dischargeJoint, simid, dischargeError) %>%
unnest(dischargeJoint) %>%
select(-Raw, -Raw.SE, -p) %>%
mutate(
LB95 = Estimate - 2*Estimate.SE,
UB95 = Estimate + 2*Estimate.SE,
Parameter = gsub("1","2",Parameter))
### Merge Results
merged <- results1 %>% ungroup %>%
left_join(results2, by = c("Parameter","simid"), suffix = c("",".death")) %>%
left_join(results3, by = c("Parameter","simid"), suffix = c("",".discharge")) %>%
left_join(truth, by = c("Parameter","simid"))
rm(results, results1, results2, results3, truth)
sumtab <-
merged %>%
#mutate( old = simid <80001) %>%
group_by(scenario, Parameter) %>%
summarise(
Truth = Truth[1],
Mean = mean(Estimate[competingError==1]),
SD = sd(Estimate[competingError==1], na.rm=T),
Correct = 100*mean((LB95 < Truth & UB95 > Truth)[competingError==1]),
Mean.death = mean(Estimate.death[deathError==1]),
SD.death = sd(Estimate.death[deathError==1], na.rm=T),
Correct.death = 100*mean((LB95.death < Truth & UB95.death > Truth)[deathError==1]),
Mean.discharge = mean(Estimate.discharge[dischargeError==1]),
SD.discharge = sd(Estimate.discharge[dischargeError==1], na.rm=T),
Correct.discharge = 100*mean((LB95.discharge < Truth & UB95.discharge > Truth)[dischargeError==1])
)
sumtab
filter(sumtab, scenario == 1) %>% print.data.frame
