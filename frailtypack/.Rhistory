load(file)
head(file)
Truth[[1]]
results <- tibble(
Truth = Truth,
simid = simid,
Parameter = map(competingJoint, ~.$Parameter),
Estimate = map(competingJoint, ~.$Estimate),
LB95 = map(competingJoint, ~.$LB95),
UB95 = map(competingJoint, ~.$UB95),
error = factor(competingError,
labels = c("None","Maxit","Calculation"),levels = c(1,2,4))) %>%
arrange(simid) %>%
distinct(simid, .keep_all = T) %>%
unnest(c(Truth, Parameter, Estimate, LB95, UB95))
head(results)
# Death Joint Model
results2 <-
tibble(
simid = simid,
Parameter = map(deathJoint, ~.$Parameter),
Estimate = map(deathJoint, ~.$Estimate),
LB95 = map(deathJoint, ~.$Estimate - 2*.$Estimate.SE),
UB95 = map(deathJoint, ~.$Estimate + 2*.$Estimate.SE),
error = factor(deathError,
labels = c("None","Maxit","Calculation"),levels = c(1,2,4))) %>%
arrange(simid) %>%
distinct(simid, .keep_all = T) %>%
unnest(c(Parameter, Estimate, LB95, UB95))
# Discharge Joint Model
results3 <- tibble(
simid = simid,
Parameter = map(dischargeJoint, ~.$Parameter),
Estimate = map(dischargeJoint, ~.$Estimate),
LB95 = map(dischargeJoint, ~.$Estimate - 2*.$Estimate.SE),
UB95 = map(dischargeJoint, ~.$Estimate + 2*.$Estimate.SE),
error = factor(dischargeError,
labels = c("None","Maxit","Calculation"),levels = c(1,2,4))) %>%
arrange(simid) %>%
distinct(simid, .keep_all = T) %>%
unnest(c(Parameter, Estimate, LB95, UB95))%>%
mutate(Parameter = gsub("1","2",Parameter))
merged <- results %>% ungroup %>%
left_join(results2, by = c("Parameter","simid"), suffix = c("",".death")) %>%
left_join(results3, by = c("Parameter","simid"), suffix = c("",".discharge"))
truth <- do.call(Truth, what = "rbind")  %>%
as.data.frame %>% mutate(simid = simid)
truth$scenario <- select(truth, betaR:trtD2) %>%
apply(1, paste, collapse = " ") %>%
factor() %>%
as.numeric
merged <- left_join(merged, truth, by = "simid")
sumtab <-
merged %>%
mutate( old = simid <80001) %>%
group_by(scenario, Parameter, old) %>%
mutate(Estimate = ifelse(Parameter == "Sigma", Estimate^2, Estimate),
LB95 = ifelse(Parameter == "Sigma", LB95^2, LB95),
UB95 = ifelse(Parameter == "Sigma", UB95^2, UB95))%>%
summarise(
Truth = Truth[1],
Mean = mean(Estimate[error=="None"]),
SD = sd(Estimate[error=="None"], na.rm=T),
Correct = 100*mean(LB95 < Truth & UB95 > Truth),
Mean.death = mean(Estimate.death[error.death=="None"]),
SD.death = sd(Estimate.death[error.death=="None"], na.rm=T),
Correct.death = 100*mean(LB95.death < Truth & UB95.death > Truth),
Mean.discharge = mean(Estimate.discharge[error.discharge=="None"]),
SD.discharge = sd(Estimate.discharge[error.discharge=="None"], na.rm=T),
Correct.discharge = 100*mean(LB95.discharge < Truth & UB95.discharge > Truth)
)%>%
mutate(Scenario = paste("Scenario",scenario))
filter(sumtab , scenario==1)
tibble(competingError = numeric())
tibble(competingJoint = list(),
deathJoint = list(),
dischargeJoint = list(),
competingError = numeric(),
deathError = numeric(),
dischargeError = numeric())
list(1:10)
meta <- readRDS("../simulation_results/Simulation_Values_MetaData.rdata")
head(meta)
all(meta$i == meta$r)
sumtab
rm(list = ls())
library(tidyverse)
library(gt)
file.list <- c("../simulation_results/Simulation_Results_Fri_Jan_14_12:04:38_2022.rdata",
"../simulation_results/Simulation_Results80000.rdata")
meta <- readRDS("../simulation_results/Simulation_Values_MetaData.rdata")
merged <- tibble()
truth <- tibble()
file = file.list[1]
file
load(file)
# Competing Joint Model
results <- tibble(
Truth = Truth,
simid = simid,
Parameter = map(competingJoint, ~.$Parameter),
Estimate = map(competingJoint, ~.$Estimate),
LB95 = map(competingJoint, ~.$LB95),
UB95 = map(competingJoint, ~.$UB95),
error = factor(competingError,
labels = c("None","Maxit","Calculation"),levels = c(1,2,4))) %>%
arrange(simid) %>%
distinct(simid, .keep_all = T) %>%
unnest(c(Truth, Parameter, Estimate, LB95, UB95))
# Competing Joint Model
results <- tibble(
Truth = Truth,
scenario = map(Truth, ~paste(., collapse = " ")) %>% unlist,
simid = simid,
Parameter = map(competingJoint, ~.$Parameter),
Estimate = map(competingJoint, ~.$Estimate),
LB95 = map(competingJoint, ~.$LB95),
UB95 = map(competingJoint, ~.$UB95),
error = factor(competingError,
labels = c("None","Maxit","Calculation"),levels = c(1,2,4))) %>%
arrange(simid) %>%
distinct(simid, .keep_all = T) %>%
unnest(c(Truth, Parameter, Estimate, LB95, UB95))
results$scenario <- as.numeric(factor(results$scenario))
sumtab <-
results %>%
group_by(scenario, Parameter) %>%
mutate(Estimate = ifelse(Parameter == "Sigma", Estimate^2, Estimate),
LB95 = ifelse(Parameter == "Sigma", LB95^2, LB95),
UB95 = ifelse(Parameter == "Sigma", UB95^2, UB95))%>%
summarise(
Truth = Truth[1],
Mean = mean(Estimate[error=="None"]),
SD = sd(Estimate[error=="None"], na.rm=T),
Correct = 100*mean(LB95 < Truth & UB95 > Truth))
sumtab
competingJoint[[1]]$Parameter
Truth[[1]]
sumtab %>% filter(Parameter == "Alpha, Terminal2")
sumtab %>% filter(Parameter == "Alpha, Terminal2") %>% arrange(Mean)
load("../simulation_results/")
load("../simulation_results/Simulation_Results_NA_NA.rdata")
head(results)
summary(results)
# Competing Joint Model
results1 <- results %>%
mutate(deathJoint = map(deathJoint,
~ mutate(.,
LB95 = Estimate - 2*Estimate.SE,
UB95 =  Estimate + 2*Estimate.SE)),
dischargeJoint = map(dischargeJoint,
~ mutate(.,
LB95 = Estimate - 2*Estimate.SE,
UB95 =  Estimate + 2*Estimate.SE,
Parameter = gsub("1","2",Parameter))),
results %>% ungroup %>%
left_join(results2, by = c("Parameter","simid"), suffix = c("",".death"))
all.models = map2(competingJoint, deathJoint,
~left_join(.x,.y, by = c("Parameter"), suffix = c("",".death"))),
all.models = map2(all.models, dischargeJoint,
~left_join(.x,.y, by = c("Parameter"), suffix = c("",".discharge")))) %>%
select(-deathJoint, -dischargeJoint, -competingJoint) %>%
unnest(all.models)
head(results)
# Competing Joint Model
results1 <- results %>%
mutate(deathJoint = map(deathJoint,
~ mutate(.,
LB95 = Estimate - 2*Estimate.SE,
UB95 =  Estimate + 2*Estimate.SE)),
dischargeJoint = map(dischargeJoint,
~ mutate(.,
LB95 = Estimate - 2*Estimate.SE,
UB95 =  Estimate + 2*Estimate.SE,
Parameter = gsub("1","2",Parameter))),
all.models = map2(competingJoint, deathJoint,
~left_join(.x,.y, by = c("Parameter"), suffix = c("",".death"))),
all.models = map2(all.models, dischargeJoint,
~left_join(.x,.y, by = c("Parameter"), suffix = c("",".discharge")))) %>%
select(-deathJoint, -dischargeJoint, -competingJoint) %>%
unnest(all.models)
head(results)
head(results1)
(results1)
results$competingJoint[[1]]
head(results)
results1 <- results %>%
select(competingJoint, betar:simid) %>%
unnest(competingJoint)%>%
select(-Raw, -Raw.SE, -p, -H0) %>%
mutate(Estimate = ifelse(Parameter == "Sigma", Estimate^2, Estimate),
LB95 = ifelse(Parameter == "Sigma", LB95^2, LB95),
UB95 = ifelse(Parameter == "Sigma", UB95^2, UB95))
results1 <- results %>%
select(competingJoint, betaR:simid) %>%
unnest(competingJoint)%>%
select(-Raw, -Raw.SE, -p, -H0) %>%
mutate(Estimate = ifelse(Parameter == "Sigma", Estimate^2, Estimate),
LB95 = ifelse(Parameter == "Sigma", LB95^2, LB95),
UB95 = ifelse(Parameter == "Sigma", UB95^2, UB95))
# Death Joint Model
results2 <-results %>%
select(deathJoint, simid) %>%
unnest(deathJoint) %>%
mutate(
LB95 = Estimate - 2*Estimate.SE,
UB95 = Estimate + 2*Estimate.SE)
# Discharge Joint Model
results3 <- results %>%
select(dischargeJoint, simid) %>%
unnest(dischargeJoint) %>%
mutate(
LB95 = Estimate - 2*Estimate.SE,
UB95 = Estimate + 2*Estimate.SE,
Parameter = gsub("1","2",Parameter))
### Merge Results
merged <- results %>% ungroup %>%
left_join(results2, by = c("Parameter","simid"), suffix = c("",".death")) %>%
left_join(results3, by = c("Parameter","simid"), suffix = c("",".discharge")) %>%
bind_rows(merged)
head(results3)
results1$scenario <- select(results1, betaR:trtD2) %>% apply(1, paste0, collapse=" ") %>% factor %>% as.numeric
results1 %>%
group_by(scenario, Parameter) %>%
summarise(
Truth = Truth[1],
Mean = mean(Estimate[error=="None"]),
SD = sd(Estimate[error=="None"], na.rm=T))
results1 %>%
group_by(scenario, Parameter) %>%
summarise
Mean = mean(Estimate[error=="None"]),
SD = sd(Estimate[error=="None"], na.rm=T))
results1 %>%
group_by(scenario, Parameter) %>%
summarise(
Mean = mean(Estimate[error=="None"]),
SD = sd(Estimate[error=="None"], na.rm=T))
results1 %>%
group_by(scenario, Parameter) %>%
summarise(
Mean = mean(Estimate, na.rm=T),
SD = sd(Estimate, na.rm=T))
truth <- select(results, simid, betaR:trtD) %>%
pivot_longer(names_to = "Parameter", values_to = "Truth", cols = betaR:trtD)
truth
truth <- select(results, simid, betaR:trtD) %>%
pivot_longer(names_to = "Parameter", values_to = "Truth", cols = betaR:trtD) %>%
mutate(Parameter = results$competingJoint[[1]]$Parameter)
truth <- select(results, simid, betaR:trtD) %>%
pivot_longer(names_to = "Parameter", values_to = "Truth", cols = betaR:trtD) %>%
mutate(Parameter = rep(results$competingJoint[[1]]$Parameter, nrow(results)))
truth <- select(results, simid, betaR:trtD2) %>%
pivot_longer(names_to = "Parameter", values_to = "Truth", cols = betaR:trtD2) %>%
mutate(Parameter = rep(results$competingJoint[[1]]$Parameter, nrow(results)))
merged %>% group_by(scenario, Parameter) %>%
summarise(
Truth = Truth[1],
Mean = mean(Estimate),
SD = sd(Estimate, na.rm=T),
Correct = 100*mean(LB95 < Truth & UB95 > Truth))
### Merge Results
merged <- results %>% ungroup %>%
left_join(results2, by = c("Parameter","simid"), suffix = c("",".death")) %>%
left_join(results3, by = c("Parameter","simid"), suffix = c("",".discharge")) %>%
left_join(truth, by = c("Parameter","simid")) %>%
bind_rows(merged)
head(truth)
file.list <- c("../simulation_results/Simulation_Results_80003_155000.rdata",
"../simulation_results/Simulation_Results80000.rdata")
rm(list = ls())
library(tidyverse)
library(gt)
file.list <- c("../simulation_results/Simulation_Results_80003_155000.rdata",
"../simulation_results/Simulation_Results80000.rdata")
file = file.list[1]
truth <- select(results, simid, betaR:trtD2) %>%
pivot_longer(names_to = "Parameter", values_to = "Truth", cols = betaR:trtD2) %>%
mutate(Parameter = rep(results$competingJoint[[1]]$Parameter, nrow(results)))
load(file)
truth <- select(results, simid, betaR:trtD2) %>%
pivot_longer(names_to = "Parameter", values_to = "Truth", cols = betaR:trtD2) %>%
mutate(Parameter = rep(results$competingJoint[[1]]$Parameter, nrow(results)))
results1 <- results %>%
select(competingJoint, betaR:simid) %>%
unnest(competingJoint)%>%
select(-Raw, -Raw.SE, -p, -H0) %>%
mutate(Estimate = ifelse(Parameter == "Sigma", Estimate^2, Estimate),
LB95 = ifelse(Parameter == "Sigma", LB95^2, LB95),
UB95 = ifelse(Parameter == "Sigma", UB95^2, UB95))
results1$scenario <- select(results1, betaR:trtD2) %>% apply(1, paste0, collapse=" ") %>% factor %>% as.numeric
head(results)
results1 <- results %>%
select(competingJoint, simid,betaR:trtD2) %>%
unnest(competingJoint)%>%
select(-Raw, -Raw.SE, -p, -H0) %>%
mutate(Estimate = ifelse(Parameter == "Sigma", Estimate^2, Estimate),
LB95 = ifelse(Parameter == "Sigma", LB95^2, LB95),
UB95 = ifelse(Parameter == "Sigma", UB95^2, UB95))
results1$scenario <- select(results1, betaR:trtD2) %>% apply(1, paste0, collapse=" ") %>% factor %>% as.numeric
# Death Joint Model
results2 <-results %>%
select(deathJoint, simid) %>%
unnest(deathJoint) %>%
select(-Raw, -Raw.SE, -p) %>%
mutate(
LB95 = Estimate - 2*Estimate.SE,
UB95 = Estimate + 2*Estimate.SE)
# Discharge Joint Model
results3 <- results %>%
select(dischargeJoint, simid) %>%
unnest(dischargeJoint) %>%
select(-Raw, -Raw.SE, -p) %>%
mutate(
LB95 = Estimate - 2*Estimate.SE,
UB95 = Estimate + 2*Estimate.SE,
Parameter = gsub("1","2",Parameter))
### Merge Results
merged <- results %>% ungroup %>%
left_join(results2, by = c("Parameter","simid"), suffix = c("",".death")) %>%
left_join(results3, by = c("Parameter","simid"), suffix = c("",".discharge")) %>%
left_join(truth, by = c("Parameter","simid")) %>%
bind_rows(merged)
head(truth)
head(results3)
head(results2)
head(results1)
head(truth)
### Merge Results
merged <- results %>% ungroup %>%
left_join(results2, by = c("Parameter","simid"), suffix = c("",".death")) %>%
left_join(results3, by = c("Parameter","simid"), suffix = c("",".discharge")) %>%
left_join(truth, by = c("Parameter","simid"))
results %>% ungroup %>%
left_join(results2, by = c("Parameter","simid"), suffix = c("",".death"))
results
### Merge Results
merged <- results1 %>% ungroup %>%
left_join(results2, by = c("Parameter","simid"), suffix = c("",".death")) %>%
left_join(results3, by = c("Parameter","simid"), suffix = c("",".discharge")) %>%
left_join(truth, by = c("Parameter","simid"))
rm(results)
sumtab <-
merged %>%
#mutate( old = simid <80001) %>%
group_by(scenario, Parameter) %>%
summarise(
Truth = Truth[1],
Mean = mean(Estimate[error=="None"]),
SD = sd(Estimate[error=="None"], na.rm=T),
Correct = 100*mean(LB95 < Truth & UB95 > Truth),
Mean.death = mean(Estimate.death[error.death=="None"]),
SD.death = sd(Estimate.death[error.death=="None"], na.rm=T),
Correct.death = 100*mean(LB95.death < Truth & UB95.death > Truth),
Mean.discharge = mean(Estimate.discharge[error.discharge=="None"]),
SD.discharge = sd(Estimate.discharge[error.discharge=="None"], na.rm=T),
Correct.discharge = 100*mean(LB95.discharge < Truth & UB95.discharge > Truth)
)%>%
mutate(Scenario = paste("Scenario",scenario))
rm(list = ls())
file.list <- c("../simulation_results/Simulation_Results_80003_155000.rdata",
"../simulation_results/Simulation_Results80000.rdata")
file = file.list[1]
load(file)
truth <- select(results, simid, betaR:trtD2) %>%
pivot_longer(names_to = "Parameter", values_to = "Truth", cols = betaR:trtD2) %>%
mutate(Parameter = rep(results$competingJoint[[1]]$Parameter, nrow(results)))
results1 <- results %>%
select(competingJoint, simid,betaR:trtD2, competingError) %>%
unnest(competingJoint)%>%
select(-Raw, -Raw.SE, -p, -H0) %>%
mutate(Estimate = ifelse(Parameter == "Sigma", Estimate^2, Estimate),
LB95 = ifelse(Parameter == "Sigma", LB95^2, LB95),
UB95 = ifelse(Parameter == "Sigma", UB95^2, UB95))
results1$scenario <- select(results1, betaR:trtD2) %>% apply(1, paste0, collapse=" ") %>% factor %>% as.numeric
# Death Joint Model
results2 <-results %>%
select(deathJoint, simid, deathError) %>%
unnest(deathJoint) %>%
select(-Raw, -Raw.SE, -p) %>%
mutate(
LB95 = Estimate - 2*Estimate.SE,
UB95 = Estimate + 2*Estimate.SE)
# Discharge Joint Model
results3 <- results %>%
select(dischargeJoint, simid, dischargeError) %>%
unnest(dischargeJoint) %>%
select(-Raw, -Raw.SE, -p) %>%
mutate(
LB95 = Estimate - 2*Estimate.SE,
UB95 = Estimate + 2*Estimate.SE,
Parameter = gsub("1","2",Parameter))
### Merge Results
merged <- results1 %>% ungroup %>%
left_join(results2, by = c("Parameter","simid"), suffix = c("",".death")) %>%
left_join(results3, by = c("Parameter","simid"), suffix = c("",".discharge")) %>%
left_join(truth, by = c("Parameter","simid"))
table(results$competingError)
table(results$deathError)
table(results$dischargeError)
sumtab <-
merged %>%
#mutate( old = simid <80001) %>%
group_by(scenario, Parameter) %>%
summarise(
Truth = Truth[1],
Mean = mean(Estimate[competingError=="None"]),
SD = sd(Estimate[competingError=="None"], na.rm=T),
Correct = 100*mean((LB95 < Truth & UB95 > Truth)[competingError=="None"]),
Mean.death = mean(Estimate.death[deathError=="None"]),
SD.death = sd(Estimate.death[deathError=="None"], na.rm=T),
Correct.death = 100*mean((LB95.death < Truth & UB95.death > Truth)[deathError=="None"]),
Mean.discharge = mean(Estimate.discharge[dischargeError=="None"]),
SD.discharge = sd(Estimate.discharge[dischargeError=="None"], na.rm=T),
Correct.discharge = 100*mean((LB95.discharge < Truth & UB95.discharge > Truth)[dischargeError=="None"])
)%>%
mutate(Scenario = paste("Scenario",scenario))
head(sumtab)
sumtab <-
merged %>%
#mutate( old = simid <80001) %>%
group_by(scenario, Parameter) %>%
summarise(
Truth = Truth[1],
Mean = mean(Estimate[competingError==1]),
SD = sd(Estimate[competingError==1], na.rm=T),
Correct = 100*mean((LB95 < Truth & UB95 > Truth)[competingError==1]),
Mean.death = mean(Estimate.death[deathError==1]),
SD.death = sd(Estimate.death[deathError==1], na.rm=T),
Correct.death = 100*mean((LB95.death < Truth & UB95.death > Truth)[deathError==1]),
Mean.discharge = mean(Estimate.discharge[dischargeError==1]),
SD.discharge = sd(Estimate.discharge[dischargeError==1], na.rm=T),
Correct.discharge = 100*mean((LB95.discharge < Truth & UB95.discharge > Truth)[dischargeError==1])
)%>%
mutate(Scenario = paste("Scenario",scenario))
sumtab
sumtab
merged %>%
filter(simid < 90000 & simid > 85000) %>%
group_by( Parameter) %>%
summarise(
Truth = Truth[1],
Mean = mean(Estimate[competingError==1]),
SD = sd(Estimate[competingError==1], na.rm=T),
Correct = 100*mean((LB95 < Truth & UB95 > Truth)[competingError==1]))
merged %>%
group_by( Parameter) %>%
summarise(
Truth = Truth[1],
Mean = mean(Estimate[competingError==1]),
SD = sd(Estimate[competingError==1], na.rm=T),
Correct = 100*mean((LB95 < Truth & UB95 > Truth)[competingError==1]))
merged %>% filter(Parameter == "Alpha, Terminal2") %>%
group_by( Truth) %>%
summarise(
Mean = mean(Estimate[competingError==1]),
SD = sd(Estimate[competingError==1], na.rm=T),
Correct = 100*mean((LB95 < Truth & UB95 > Truth)[competingError==1]))
merged %>% filter(Parameter == "Alpha, Terminal2") %>%
ggplot() +
geom_point(aes(x = simid, y = Estimate))
geom_point(aes(x = simid, y = Estimate)) + ylim(-3,3)
merged %>% filter(Parameter == "Alpha, Terminal2") %>%
ggplot() +
geom_point(aes(x = simid, y = Estimate)) + ylim(-3,3)
merged %>% filter(Parameter == "Alpha, Terminal2") %>%
ggplot()+
geom_line(aes(x = simid, y = Estimate))+
stat_smooth(aes(x = simid, y = Estimate), se = F)
merged %>% filter(Parameter == "Alpha, Terminal2") %>%
ggplot()+
stat_smooth(aes(x = simid, y = Estimate), se = F)
merged %>% filter(Parameter == "Alpha, Terminal2" & simid < 100000) %>%
ggplot()+
geom_point(aes(x = simid, y = Estimate)) + ylim(-3,3)
merged %>% filter(Parameter == "Alpha, Terminal2" & simid < 100000) %>%
ggplot()+
geom_point(aes(x = simid, y = Estimate), alpha = .2) + ylim(-3,3)
rm(list = ls())
load("../simulation_results/Simulation_Results_80003_155000.rdata")
head(results)
results <- select(results, simid, deaths:trtD2)
lm(data = results, deaths ~alpha2)
lm(data = results, deaths ~ factor(alpha2))
lm(data = results, deaths ~ factor(alpha2)) %>% summary
lm(data = results, deaths ~ factor(theta) + factor(alpha1) + factor(alpha2) +
factor(trtR)+ factor(trtD)+ factor(trtD2)) %>% summary
results %>% filter(theta == 0.5, alpha1 == 0, trtR == 0, trtD ==0, trtD2 ==0)
results %>% filter(theta == 0.5, alpha1 == 0, trtR == 0, trtD ==0, trtD2 ==0)  %>%
pivot_longer(cols = deaths : events.pl)
results %>% filter(theta == 0.5, alpha1 == 0, trtR == 0, trtD ==0, trtD2 ==0)  %>%
pivot_longer(cols = deaths : events.pl) %>%
group_by(alpha2, name) %>% summarise(mean(value))
results %>% filter(theta == 0.5, alpha1 == 0, trtR == 0, trtD ==0, trtD2 ==0)  %>%
pivot_longer(cols = deaths : events.pl) %>%
group_by(alpha2, name) %>% summarise(m = mean(value)) %>%
pivot_wider(names_from = "name", values_from = "m")
results %>% filter(theta == 0.5, alpha2 ==0, alpha1 == 0, trtD ==0, trtD2 ==0)  %>%
pivot_longer(cols = deaths : events.pl) %>%
group_by(trtR, name) %>%
summarise(m = mean(value)) %>%
pivot_wider(names_from = "name", values_from = "m")
results %>% filter(theta == 0.5, alpha2 ==0, alpha1 == 0, trtR == 0, trtD ==0)  %>%
pivot_longer(cols = deaths : events.pl) %>%
group_by(trtD2, name) %>%
summarise(m = mean(value)) %>%
pivot_wider(names_from = "name", values_from = "m")
results %>% filter( alpha2 ==0, alpha1 == 0, trtR == 0, trtD ==0, trtD2 ==0)  %>%
pivot_longer(cols = deaths : events.pl) %>%
group_by(theta, name) %>%
summarise(m = mean(value)) %>%
pivot_wider(names_from = "name", values_from = "m")
